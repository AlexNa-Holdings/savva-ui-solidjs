# Попередні вимоги

Перед встановленням SAVVA перевірте, що ваше середовище відповідає наведеним нижче вимогам.

## Вимоги до сервера

### Апаратне забезпечення

- **CPU**: рекомендовано 2+ ядра
- **RAM**: мінімум 4 ГБ, рекомендовано 8 ГБ
- **Storage**: SSD 50 ГБ+ (зростає зі вмістом)
- **Network**: стабільне інтернет-з'єднання з публічною IP-адресою

### Операційна система

- **Linux**: Ubuntu 20.04 LTS або новіша (рекомендовано)
- **Альтернатива**: Debian 10+, CentOS 8+ або будь-який сучасний дистрибутив Linux
- **macOS/Windows**: можливі для розробки, не рекомендовано для продакшн

## Вимоги до програмного забезпечення

### 1. База даних PostgreSQL

**Потрібна версія**: PostgreSQL 14 або новіша

У вас є два варіанти:

**Варіант A: Керована база даних** (Рекомендовано для продакшн)

Рекомендуємо **DigitalOcean Managed Databases** для продакшн-розгортань:

- **Переваги**:
  - Автоматичні резервні копії та відновлення до певного моменту часу
  - Автоматичні оновлення та патчі безпеки
  - Висока доступність та відмовостійкість
  - Моніторинг та оповіщення
  - Жодного адміністративного навантаження на базу даних

- **Налаштування**:
  1. Створіть акаунт на https://digitalocean.com
  2. Перейдіть у Databases → Create Database
  3. Виберіть PostgreSQL 14 або новішу версію
  4. Оберіть план (починається від $15/місяць)
  5. Виберіть регіон датацентру (ближче до вашого сервера)
  6. Занотуйте дані підключення (хост, порт, ім'я користувача, пароль, назва бази даних)

**Варіант B: Самохостинг** (Для розробки або кастомних налаштувань)

Встановіть PostgreSQL на власному сервері:

```bash
# Required version check
psql --version  # Should output: psql (PostgreSQL) 14.x or higher
```

Встановлення на Ubuntu:
```bash
sudo apt update
sudo apt install postgresql postgresql-contrib
sudo systemctl start postgresql
sudo systemctl enable postgresql
```

### 2. Сховище IPFS

SAVVA потребує як локального вузла IPFS, так і зовнішнього pinning-сервісу для надійного зберігання контенту.

**A. Локальний вузол IPFS** (Обов'язково)

Встановіть і запустіть локальний вузол IPFS для обробки контенту:

```bash
# Install IPFS Kubo
wget https://dist.ipfs.tech/kubo/v0.24.0/kubo_v0.24.0_linux-amd64.tar.gz
tar -xvzf kubo_v0.24.0_linux-amd64.tar.gz
cd kubo
sudo bash install.sh

# Initialize IPFS
ipfs init

# Configure IPFS (optional: increase connection limits)
ipfs config Datastore.StorageMax 50GB

# Start IPFS daemon
ipfs daemon
```

Для продакшну налаштуйте IPFS як системну службу:
```bash
sudo nano /etc/systemd/system/ipfs.service
```

```ini
[Unit]
Description=IPFS Daemon
After=network.target

[Service]
Type=simple
User=youruser
ExecStart=/usr/local/bin/ipfs daemon
Restart=on-failure

[Install]
WantedBy=multi-user.target
```

```bash
sudo systemctl enable ipfs
sudo systemctl start ipfs
```

**B. Зовнішній pinning-сервіс** (Обов'язково)

Щоб гарантувати збереження та доступність контенту, ви повинні підписатися щонайменше на один pinning-сервіс IPFS:

**Рекомендовані сервіси:**

1. **Pinata** (https://pinata.cloud)
   - Безкоштовний тариф: 1 ГБ сховища
   - Є платні плани
   - Легка інтеграція через API
   - **Публічний шлюз**: `https://gateway.pinata.cloud/ipfs/`

2. **Web3.Storage** (https://web3.storage)
   - Доступний безкоштовний тариф
   - Побудований на Filecoin
   - Простий API
   - **Публічний шлюз**: `https://w3s.link/ipfs/`

3. **Filebase** (https://filebase.com)
   - Сумісний з API S3
   - Піннінг для IPFS включено
   - Гео-резервоване зберігання
   - **Публічний шлюз**: `https://ipfs.filebase.io/ipfs/`

4. **NFT.Storage** (https://nft.storage)
   - Безкоштовно для NFT-контенту
   - Обмежено випадками використання для NFT
   - **Публічний шлюз**: `https://nftstorage.link/ipfs/`

**Важливо**: обирайте сервіс, який надає URL публічного IPFS-шлюзу. Цей шлюз дозволяє користувачам отримувати доступ до контенту навіть якщо у них не встановлено IPFS.

**Кроки налаштування:**

1. Створіть акаунт у обраному pinning-сервісі  
2. Згенеруйте API-ключ  
3. Занотуйте URL публічного шлюзу  
4. Налаштуйте бекенд з:
   - обліковими даними API pinning-сервісу
   - URL публічного шлюзу для отримання контенту
5. Перевірте підключення перед запуском у продакшн

**Чому потрібні обидва:**

- **Локальний вузол IPFS**: швидке завантаження/завантаження контенту, локальний кеш, участь у мережі  
- **Pinning-сервіс**: гарантує збереження контенту, надлишковість, високу доступність навіть коли ваш сервер офлайн

### 3. Веб-сервер (продакшн)

Для продакшн-розгортання:

**Nginx** (Рекомендовано):
```bash
sudo apt install nginx
```

**Apache** (Альтернатива):
```bash
sudo apt install apache2
```

### 4. SSL-сертифікат

Для HTTPS (обов'язково в продакшн):

**Використання Let's Encrypt** (Безкоштовно):
```bash
sudo apt install certbot python3-certbot-nginx
sudo certbot --nginx -d yourdomain.com
```

## Вимоги до блокчейну

### Постачальник Web3

Вам потрібен доступ до сумісної з Ethereum блокчейн-мережі. SAVVA підтримує як HTTP(S), так і WebSocket (WSS) підключення.

**Типи підключень:**

- **HTTPS RPC**: `https://rpc.example.com` - стандартне HTTP-підключення
- **WSS RPC**: `wss://rpc.example.com` - **рекомендовано** для швидшої обробки подій та оновлень у реальному часі

**Рекомендовано: використовувати WSS** у продакшн-розгортаннях для:
- моніторингу подій блокчейну в реальному часі
- швидшого підтвердження транзакцій
- нижчої затримки при взаємодії з користувачем

**Варіант A: Постачальники нод (Рекомендовано)**

Рекомендуємо використовувати **AllNodes** або подібних керованих провайдерів нод:

1. **AllNodes** (https://www.allnodes.com)
   - Підтримує PulseChain, Ethereum та інші EVM-ланцюги
   - Надає і HTTPS, і WSS кінцеві точки
   - Висока доступність і надлишковість
   - Плани починаються приблизно від $20/місяць

2. **Альтернативи**:
   - **Infura** (https://infura.io) - Ethereum, Polygon, Arbitrum
   - **Alchemy** (https://alchemy.com) - кілька ланцюгів
   - **QuickNode** (https://quicknode.com) - широка підтримка ланцюгів
   - **GetBlock** (https://getblock.io) - кілька протоколів

**Кроки налаштування**:
1. Створіть акаунт у обраному провайдера  
2. Створіть нову ноду/endpoint для вашого ланцюга (наприклад, PulseChain)  
3. Отримайте як HTTPS, так і WSS URL кінцевих точок  
4. Налаштуйте бекенд для використання WSS-ендпоінту для оптимальної продуктивності

**Варіант B: Самохостинг ноди**

Запустіть власну блокчейн-ноду для максимального контролю:

- **Переваги**: повний контроль, відсутність залежності від третіх сторін, немає лімітів запитів  
- **Недоліки**: потребує значних ресурсів, постійного обслуговування  
- **Сховище**: SSD 500 ГБ+ (зростає з часом)  
- **Час синхронізації**: від кількох годин до кількох днів залежно від ланцюга

Для PulseChain:
```bash
# Example: Running a PulseChain node with go-pulse
# See official PulseChain documentation for detailed setup
```

**Мережеві вимоги**:
- URL RPC-ендпоінту (HTTPS або WSS)  
- **Рекомендовано**: WSS-ендпоінт для швидшої обробки подій  
- Приватний ключ для розгортання контрактів (якщо розгортаєте нові контракти)  
- Нативні токени для комісій (PLS для PulseChain, ETH для Ethereum тощо)

**Примітка**: всі необхідні смарт-контракти SAVVA вже розгорнуті на PulseChain. Див. [Офіційні адреси контрактів](../licenses/official-contracts.md) для повного списку.

## Конфігурація мережі

### Порти фаєрволу

Відкрийте наступні порти:

- **80**: HTTP (перенаправляє на HTTPS)
- **443**: HTTPS (інтерфейс)
- **8080**: Backend API (може бути лише для внутрішнього використання)
- **4001**: IPFS Swarm (якщо запущено локальний IPFS)
- **5001**: IPFS API (тільки localhost)
- **8545**: Ethereum RPC (якщо запущено локальну ноду)

Приклад з використанням `ufw`:
```bash
sudo ufw allow 80/tcp
sudo ufw allow 443/tcp
sudo ufw allow 8080/tcp  # Or keep internal
sudo ufw enable
```

### Налаштування DNS

Направте ваш домен на сервер:
- **A Record**: `yourdomain.com` → IP сервера
- **A Record**: `www.yourdomain.com` → IP сервера (за бажанням)

**Примітка**: бекенд API обслуговується з того ж домену за шляхом `/api` (наприклад, `https://yourdomain.com/api`), тому окремий піддомен не потрібен.

## Перевірочний список

Перед продовженням перевірте всі попередні вимоги:

- Сервер з достатніми ресурсами (2+ CPU ядра, 4 ГБ+ ОЗП, 50 ГБ+ SSD)  
- PostgreSQL 14+ встановлено та працює (або налаштована керована база даних)  
- Вузол IPFS запущено як systemd-службу  
- Pinning-сервіс IPFS налаштовано з публічним шлюзом  
- Встановлено Nginx або Apache веб-сервер  
- Домен з налаштованим DNS  
- Отримано SSL-сертифікат  
- Налаштовано доступ до RPC блокчейну (бажано WSS)  
- Відкриті порти фаєрволу